<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÄÄƒng kÃ½ - TapHoaPtit.online</title>
    <link rel="stylesheet" th:href="@{/css/auth.css}">
    <style>
        .password-input-wrapper {
            position: relative;
        }

        .password-input-wrapper input {
            padding-right: 45px !important;
        }

        .toggle-password {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            font-size: 20px;
            user-select: none;
            transition: all 0.3s;
        }

        .toggle-password:hover {
            transform: translateY(-50%) scale(1.2);
        }
    </style>
</head>
<body>
<div class="container">
    <h2>ğŸ“ ÄÄƒng kÃ½ tÃ i khoáº£n</h2>

    <div th:if="${error}" class="error" th:text="${error}"></div>
    <div th:if="${success}" class="success" th:text="${success}"></div>

    <form method="post" action="/register" id="registerForm">

        <div class="form-group">
            <label for="username">
                ğŸ‘¤ TÃªn Ä‘Äƒng nháº­p: <span class="required">*</span>
            </label>
            <input type="text"
                   id="username"
                   name="username"
                   placeholder="Nháº­p tÃªn Ä‘Äƒng nháº­p (4-20 kÃ½ tá»±)"
                   required
                   minlength="4"
                   maxlength="20"
                   autocomplete="username">
            <small class="hint">Chá»‰ sá»­ dá»¥ng chá»¯ cÃ¡i, sá»‘ vÃ  dáº¥u gáº¡ch dÆ°á»›i</small>
        </div>


        <div class="form-group">
            <label for="fullName">
                ğŸ“› Há» vÃ  tÃªn: <span class="required">*</span>
            </label>
            <input type="text"
                   id="fullName"
                   name="fullName"
                   placeholder="Nháº­p há» vÃ  tÃªn Ä‘áº§y Ä‘á»§"
                   required
                   autocomplete="name">
        </div>


        <div class="form-group">
            <label for="email">
                ğŸ“§ Email: <span class="required">*</span>
            </label>
            <input type="email"
                   id="email"
                   name="email"
                   placeholder="example@gmail.com"
                   required
                   autocomplete="email">
            <small class="hint">Email sáº½ Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ xÃ¡c thá»±c tÃ i khoáº£n</small>
        </div>


        <div class="form-group">
            <label for="password">
                ğŸ”’ Máº­t kháº©u: <span class="required">*</span>
            </label>
            <div class="password-input-wrapper">
                <input type="password"
                       id="password"
                       name="password"
                       placeholder="Nháº­p máº­t kháº©u (tá»‘i thiá»ƒu 6 kÃ½ tá»±)"
                       required
                       minlength="6"
                       autocomplete="new-password">
                <span class="toggle-password" onclick="togglePassword('password')">ğŸ‘ï¸</span>
            </div>
            <small class="hint">Tá»‘i thiá»ƒu 6 kÃ½ tá»±, nÃªn cÃ³ chá»¯ hoa, sá»‘ vÃ  kÃ½ tá»± Ä‘áº·c biá»‡t</small>
        </div>


        <div class="form-group">
            <label for="confirmPassword">
                ğŸ” XÃ¡c nháº­n máº­t kháº©u: <span class="required">*</span>
            </label>
            <div class="password-input-wrapper">
                <input type="password"
                       id="confirmPassword"
                       name="confirmPassword"
                       placeholder="Nháº­p láº¡i máº­t kháº©u"
                       required
                       minlength="6"
                       autocomplete="new-password">
                <span class="toggle-password" onclick="togglePassword('confirmPassword')">ğŸ‘ï¸</span>
            </div>
            <small class="hint error-message" id="passwordError" style="display: none;">
                âš ï¸ Máº­t kháº©u khÃ´ng khá»›p!
            </small>
        </div>

        <button type="submit" id="submitBtn">ÄÄƒng kÃ½</button>
    </form>

    <div class="link">
        <p>ÄÃ£ cÃ³ tÃ i khoáº£n? <a href="/login">ÄÄƒng nháº­p ngay</a></p>
        <p><a href="/">â† Vá» trang chá»§</a></p>
    </div>
</div>

<script>
    // Toggle password visibility
    function togglePassword(fieldId) {
        const field = document.getElementById(fieldId);
        const icon = field.nextElementSibling;

        if (field.type === 'password') {
            field.type = 'text';
            icon.textContent = 'ğŸ™ˆ';
        } else {
            field.type = 'password';
            icon.textContent = 'ğŸ‘ï¸';
        }
    }

    // Kiá»ƒm tra máº­t kháº©u khá»›p
    const password = document.getElementById('password');
    const confirmPassword = document.getElementById('confirmPassword');
    const passwordError = document.getElementById('passwordError');
    const submitBtn = document.getElementById('submitBtn');
    const form = document.getElementById('registerForm');

    function checkPasswordMatch() {
        if (confirmPassword.value === '') {
            passwordError.style.display = 'none';
            return true;
        }

        if (password.value !== confirmPassword.value) {
            passwordError.style.display = 'block';
            confirmPassword.style.borderColor = '#f44336';
            return false;
        } else {
            passwordError.style.display = 'none';
            confirmPassword.style.borderColor = '#4CAF50';
            return true;
        }
    }

    confirmPassword.addEventListener('input', checkPasswordMatch);
    password.addEventListener('input', checkPasswordMatch);

    // Validate trÆ°á»›c khi submit
    form.addEventListener('submit', function(e) {
        if (!checkPasswordMatch()) {
            e.preventDefault();
            alert('âŒ Máº­t kháº©u xÃ¡c nháº­n khÃ´ng khá»›p!');
            return false;
        }

        // Kiá»ƒm tra username chá»‰ chá»©a chá»¯ cÃ¡i, sá»‘ vÃ  dáº¥u gáº¡ch dÆ°á»›i
        const username = document.getElementById('username').value;
        const usernameRegex = /^[a-zA-Z0-9_]+$/;

        if (!usernameRegex.test(username)) {
            e.preventDefault();
            alert('âŒ TÃªn Ä‘Äƒng nháº­p chá»‰ Ä‘Æ°á»£c chá»©a chá»¯ cÃ¡i, sá»‘ vÃ  dáº¥u gáº¡ch dÆ°á»›i!');
            return false;
        }
    });
</script>
</body>
</html>